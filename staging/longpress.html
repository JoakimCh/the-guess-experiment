
<div id="container" style="width:200px; height:200px; background:#eee; padding:20px;">
  <div class="nested" style="width:100px; height:100px; background:#ddd;">
      <div class="deep" style="width:50px; height:50px; background:#bbb;"></div>
  </div>
</div>

<script>

const log = console.log

class PressHandler {
  #timer; #element
  
  longPressDuration
  onPress; onLongPress

  constructor(element, longPressDuration = 800) {
    this.#element = element
    this.longPressDuration = longPressDuration
    element.addEventListener('touchstart', this.#startPress)
    element.addEventListener('touchmove', this.#checkTouchPosition)
    element.addEventListener('touchend', this.#endPress)
    element.addEventListener('touchcancel', this.#endPress)
  }

  #checkTouchPosition = (e) => {
    const touch = e.touches[0]
    const touchedElement = document.elementFromPoint(touch.clientX, touch.clientY)
    if (touchedElement && !this.#element.contains(touchedElement)) {
      this.#endPress()
    }
  }

  #startPress = (e) => {
    e.preventDefault()
    this.onPress?.()
    this.#timer = setTimeout(() => {
      this.onLongPress?.()
    }, this.longPressDuration)
  }

  #endPress = (e) => {
    clearTimeout(this.#timer)
  }
}

class CardSelectHandler {
  #cards

  constructor(cards) {
    this.#cards = cards
  }
}

new PressHandler(container)

</script>
